Java.perform(function () {
  var className = Java.use("Xk011b72bcbf5396b4f9ec9737b706f44.Xkfb2bcfa7ae858b5247a4fc3c5ae3020.Xk0ffa93357fdb71b824a5c8a5e09f7a9.Xk2ab51ae5d2d6e55927c67094cd5898a.Xk73acf46ad0e0b2536b5ceab6476ddf6.Xka47f12b28dac20a3e1bfe39b0c8b001$1");
  className.onResponse.overload('java.util.HashMap').implementation = function (arg0) {
    console.log("[*] Hooking C&C server response callback");
    //  Error removal in case of unreachable server
    arg0.remove('error');
    //  Command formatting in response map
    arg0.put('body', '{"response":[{"command": "calls get"}]}');
    const JSONObject = Java.use('org.json.JSONObject');
    const jobjt = JSONObject.$new(arg0.get('body')).getJSONArray("response");
    const resp = jobjt.getJSONObject(0).get("command").toString().replaceAll("\\s+$", "");
    console.log("[*] Changing server response to " + resp);
    return this.onResponse(arg0)
  }
});